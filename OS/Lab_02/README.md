Тут можно убрать иф из цикла потому что вы не дурак а программист, и, как мне кажется, первые 2 директории это . и .. и их всегда можно скипнуть